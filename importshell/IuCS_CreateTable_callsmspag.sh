#!/bin/sh
impala-shell <<EOF

use test;
CREATE EXTERNAL TABLE test.s_xdr_iucs_call_$1_$2 ( 
	SpecFlag string,
	CFType string,
	EndCGI string,
	RRANType string,
	RMSC string,
	RMSC_GT string,
	RDirection string,
	MSRN string,
	RPrefix string,
	RPhone string,
	RIMSI string,
	ROperator string,
	OCalled string,
	CalledNum string,
	SCP string,
	SCP_GT string,
	CIC string,
	TalkLen int,
	CallDropFlag string,
	VideoBackCause string,
	Delay_CMReq int,
	Delay_CMRes int,
	PagingTimes int,
	Delay_PagingReq_1st int,
	Delay_PagingReq_2nd int,
	Delay_PagingReq_3rd int,
	Delay_PagingReq_More int,
	Delay_PagingRes int,
	Delay_Paging_Net int,
	GlobalFlag string,
	Delay_Setup int,
	Delay_CallProc int,
	Delay_IDP int,
	Delay_Connect_CAP int,
	Delay_Release_CAP int,
	Delay_AssignReq int,
	Delay_AssignCmp int,
	Delay_SRI int,
	Delay_SRIRes int,
	Delay_PRN int,
	Delay_PRNRes int,
	Delay_IAM int,
	Delay_ACM int,
	Delay_Alerting int,
	Delay_ANM int,
	Delay_Connect int,
	Delay_ConnectAck int,
	Delay_Disconnect int,
	Delay_REL int,
	Delay_RLC int,
	Delay_Release int,
	Delay_ReleaseCmp int,
	Delay_ClearReq int,
	Delay_ClearCmd int,
	Delay_ClearCmp int,
	ExCallResult string,
	CallInterval int,
	RelDirection string,
	HODuration int,
	HOTimes int,
	AuthTimes int,
	Delay_AuthReq_1st int,
	Delay_AuthReq_2nd int,
	Delay_AuthRes int,
	AuthResult_1st string,
	AuthEroorCode_1st string,
	AucVecCount string,
	Delay_AucVecReq int,
	Delay_AucVecRes int,
	EncryAlgorithm string,
	Delay_CIPCmd int,
	Delay_CIPCmp int,
	Delay_TMSICmd int,
	Delay_TMSICmp int,
	IdentityType string,
	Delay_IDReq int,
	Delay_IDRes int,
	HLR string,
	HLR_GT string,
	ErrorPhaseInd string,
	RANType string,
	MSC string,
	MSC_GT string,
	MSCIP string,
	MGWIP string,
	BSC string,
	LAI string,
	CGI string,
	TMSI string,
	IMEI string,
	IMEIRanType string,
	VProvince string,
	VCity string,
	VCountry string,
	StartTime timestamp,
	EndTime timestamp,
	EventType string,
	SubevtType string,
	CombFlag string,
	UserARD string,
	UserType string,
	PhonePrefix string,
	Phone string,
	IMSI string,
	HCountry string,
	HProvince string,
	HCity string,
	RoamType string,
	HOperator string,
	Result string,
	ErrorCode string,
	ReleaserCode string,
	FailureMsg string,
	FailurePreMsg string,
	TDRID string,
	CallID string,
	Test1 string,
	Test2 string,
	Delay_Setup2 string,
	CSMO string,
	EndOfCSFB string,
	FddSupport string,
	TddSupport string,
	RAND string,
	AUTN string   
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/user/hive/warehouse/test.db/s_xdr_iucs_call_$1_$2';


CREATE EXTERNAL TABLE test.s_xdr_iucs_sms_$1_$2 ( 
SpecFlag                string,
RPrefix                 string,
RPhone                  string,
RIMSI                   string,
ROperator               string,
SMC                     string,
SMC_GT                  string,
SCP                     string,
SCP_GT                  string,
Delay_CMReq             int,
Delay_CMRes             int,
Delay_SRI               int,
Delay_SRIRes            int,
PagingTimes             int,
Delay_PagingReq_1st     int,
Delay_PagingReq_2nd     int,
Delay_PagingReq_3rd     int,
Delay_PagingReq_More    int,
Delay_PagingRes         int,
Delay_Paging_Net        int,
GlobalFlag              string,
Delay_CPDATA            int,
Delay_Forward           int,
Delay_ForwardAck        int,
Delay_CPDATAAck         int,
SMC_Addr                string,
AuthTimes               string,
Delay_AuthReq_1st       int,
Delay_AuthReq_2nd       int,
Delay_AuthRes           int,
AuthResult_1st          string,
AuthEroorCode_1st       string,
AucVecCount             string,
Delay_AucVecReq         int,
Delay_AucVecRes         int,
EncryAlgorithm          string,
Delay_CIPCmd            int,
Delay_CIPCmp            int,
Delay_TMSICmd           int,
Delay_TMSICmp           int,
IdentityType            string,
Delay_IDReq             int,
Delay_IDRes             int,
HLR                     string,
HLR_GT                  string,
ErrorPhaseInd           string,
RANType                 string,
MSC                     string,
MSC_GT                  string,
MSCIP                   string,
MGWIP                   string,
BSC                     string,
LAI                     string,
CGI                     string,
TMSI                    string,
IMEI                    string,
IMEIRanType             string,
VProvince               string,
VCity                   string,
VCountry                string,
StartTime               timestamp,
EndTime                 timestamp,
EventType               string,
SubevtType              string,
CombFlag                string,
UserARD                 string,
UserType                string,
PhonePrefix             string,
Phone                   string,
IMSI                    string,
HCountry                string,
HProvince               string,
HCity                   string,
RoamType                string,
HOperator               string,
Result                  string,
ErrorCode               string,
ReleaserCode            string,
FailureMsg              string,
FailurePreMsg           string,
TDRID                   string,
CallID                  string,
Test1                   string,
Test2                   string
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/user/hive/warehouse/test.db/s_xdr_iucs_sms_$1_$2';


CREATE EXTERNAL TABLE test.s_xdr_iucs_pag_$1_$2 ( 
PagingTimes	            int,
Delay_PagingReq_1st	    int,
Delay_PagingReq_2nd	    int,
Delay_PagingReq_3rd	    int,
Delay_PagingReq_More	int,
Delay_PagingRes	        int,
Delay_Paging_Net	    int,
GlobalFlag	            string,
AuthTimes	            int,
Delay_AuthReq_1st	    int,
Delay_AuthReq_2nd	    int,
Delay_AuthRes	        int,
AuthResult_1st	        string,
AuthEroorCode_1st	    int,
AucVecCount	            string,
Delay_AucVecReq	        int,
Delay_AucVecRes	        int,
EncryAlgorithm	        string,
Delay_CIPCmd	        int,
Delay_CIPCmp	        int,
Delay_TMSICmd	        int,
Delay_TMSICmp	        int,
IdentityType	        string,
Delay_IDReq	            int,
Delay_IDRes	            int,
HLR	                    string,
HLR_GT	                string,
ErrorPhaseInd	        string,
RANType		            string,
MSC	                    string,
MSC_GT	                string,
MSCIP	                string,
MGWIP	                string,
BSC	                    string,
LAI	                    string,
CGI	                    string,
TMSI	                string,
IMEI	                string,
IMEIRanType	            string,
VProvince	            string,
VCity	                string,
VCountry	            string,
StartTime	            timestamp,
EndTime	                timestamp,
EventType	            string,
SubevtType	            string,
CombFlag	            string,
UserARD	                string,
UserType	            string,
PhonePrefix	            string,
Phone	                string,
IMSI	                string,
HCountry	            string,
HProvince	            string,
HCity	                string,
RoamType	            string,
HOperator	            string,
Result	                string,
ErrorCode	            string,
ReleaserCode	        string,
FailureMsg	            string,
FailurePreMsg	        string,
TDRID	                string,
CallID	                string,
Test1	                string,
Test2	                string,
ExcpagingFlag	        string
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/user/hive/warehouse/test.db/s_xdr_iucs_pag_$1_$2';

exit;
<<EOF
