#!/bin/sh
impala-shell <<EOF
use test;
CREATE EXTERNAL TABLE test.s_xdr_iups_rau_$1_$2 ( 
STARTTIME           string,
ENDTIME             string,
EVENTTYPE           string,
RANTYPE             string,
COMBFLAG            string,
PHONE               string,
IMSI                string,
IMEI                string,
USERIP              string,
HCOUNTRY            string,
HPROVINCE           string,
HCITY               string,
APN                 string,
SGSN                string,
GGSN                string,
RNC                 string,
RAC                 string,
CELL                string,
HOPERATOR           string,
VISITPROV           string,
VISITCITY           string,
ROAMTYPE            string,
RESULT              string,
ERRORCODE           string,
RELEASERCODE        string,
FAILUREMSG          string,
FAILUREPREMSG       string,
NTID                string,
SUBEVTTYPE          string,
TMSI                string,
TLLI                string,
DELAY_IDREQ         int,
DELAY_IDRES         int,
TRYIDS              string,
DELAY_SAREQ         int,
DELAY_SARES         int,
DELAY_AUCREQ        int,
DELAY_AUCRES        int,
TRYAUTHS            string,
AUTHTIMES           string,
DELAY_SECREQ        int,
DELAY_SECRES        int,
TRYSECS             string,
DELAY_RELREQ        int,
DELAY_RELCMD        int,
DELAY_RELCMP        int,
RESULT_IUREL        string,
CAUSE_IUREL         string,
INTERSGSN           string,
PEERRAC             string,
PEERRAT             string,
DELAY_RAUREQ        int,
DELAY_RAURES        int,
DELAY_DNSREQ        int,
DELAY_DNSRES        int,
DELAY_SGSNCTXREQ    int,
DELAY_SGSNCTXRES    int,
DELAY_SRNSCTXREQ    int,
DELAY_SRNSCTXRES    int,
DELAY_UPPDPREQ      int,
DELAY_UPPDPRES      int,
DELAY_LUREQ         int,
DELAY_LURES         int,
DELAY_CANCREQ       int,
DELAY_CANCRES       int,
DELAY_INSREQ        int,
DELAY_INSRES        int,
DELAY_MODIREQ       int,
DELAY_MODIRES       int,
PEERSGSN            string,
PEERRNC             string,
RAND                string,
AUTN                string
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/user/hive/warehouse/test.db/s_xdr_iups_rau_$1_$2';

CREATE EXTERNAL TABLE test.s_xdr_iups_pagserv_$1_$2 ( 
STARTTIME           string, 
ENDTIME             string,
EVENTTYPE           string,
RANTYPE             string,
COMBFLAG            string,
PHONE               string,
IMSI                string,
IMEI                string,
USERIP              string,
HCOUNTRY            string,
HPROVINCE           string,
HCITY               string,
APN                 string,
SGSN                string,
GGSN                string,
RNC                 string,
RAC                 string,
CELL                string,
HOPERATOR           string,
VISITPROV           string,
VISITCITY           string,
ROAMTYPE            string,
RESULT              string,
ERRORCODE           string,
RELEASERCODE        string,
FAILUREMSG          string,
FAILUREPREMSG       string,
NTID                string,
SUBEVTTYPE          string,
TMSI                string,
TLLI                string,
DELAY_IDREQ         int,
DELAY_IDRES         int,
TRYIDS              string,
DELAY_SAREQ         int,
DELAY_SARES         int,
DELAY_AUCREQ        int,
DELAY_AUCRES        int,
TRYAUTHS            string,
AUTHTIMES           string,
DELAY_SECREQ        int,
DELAY_SECRES        int,
TRYSECS             string,
DELAY_RELREQ        int,
DELAY_RELCMD        int,
DELAY_RELCMP        int,
RESULT_IUREL        string,
CAUSE_IUREL         string,
DELAY_PAGINGREQ     int,
DELAY_PAGINGRES     int,
DELAY_SERVREQ       int,
DELAY_SERVRES       int,
DELAY_RABREQ        int,
DELAY_RABRES        int,
DELAY_UPPDPREQ      int,
DELAY_UPPDPRES      int,
DELAY_MODIREQ       int,
DELAY_MODIRES       int,
SRCPORT             string,
DSTPORT             string,
HOST                string,
PDUTYPE             string,
RESULT_RABREL       string,
CAUSE_RABREL        string,
SigUpRate           string,
SigDownRate         string,
ConUpRate           string,
ConDownRate         string,
ActUpRate           string,
ActDownRate         string,
RAND                string,
AUTN                string
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
LOCATION '/user/hive/warehouse/test.db/s_xdr_iups_pagserv_$1_$2';


exit;
<<EOF
